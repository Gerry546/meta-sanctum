{
    "version": "2.0.0",
    "tasks": [
        {
            "label": "Git update layers",
            "type": "shell",
            "command": "${workspaceFolder}/scripts/pull_modules",
            "group": "none",
            "problemMatcher": []
        },
        {
            "label": "HomeAssistant: upgrade integrations",
            "type": "shell",
            "command": "python3 ${workspaceFolder}/scripts/run_ha_upgrades_from_csv.py -v ${input:haVersions}",
            "group": "none",
            "problemMatcher": []
        },
        {
            "label": "Devtool Helper",
            "type": "shell",
            "command": "${workspaceFolder}/scripts/devtool-pypi-helper.sh ${input:devtoolAddAction} ${input:devtoolRecipeName} ${input:buildDirectory}",
            "group": "none",
            "problemMatcher": []
        },
        {
            "label": "Auto Upgrade Helper",
            "type": "shell",
            "command": "source /home/tom/projects/meta-sanctum/build-${input:buildDirectory}/build/init-build-env &&  ${workspaceFolder}/auto-upgrade-helper/upgrade-helper.py -c ${workspaceFolder}/utils/upgrade-helper.conf ${input:recipeName}",
            "group": "none",
            "problemMatcher": []
        },
        {
            "label": "Rauc Test: qemuarm64-a72",
            "type": "shell",
            "command": "${workspaceFolder}/tests/rauc-test.sh qemuarm64-a72",
            "group": "test",
            "dependsOn": [
                "Build Sanctum Qemuarm64-a72"
            ],
            "dependsOrder": "sequence",
            "problemMatcher": []
        },
        {
            "label": "Rauc Test: qemux86-64n",
            "type": "shell",
            "command": "${workspaceFolder}/tests/rauc-test.sh qemux86-64n",
            "group": "test",
            "dependsOn": [
                "Build Sanctum QemuX86n-64n"
            ],
            "dependsOrder": "sequence",
            "problemMatcher": []
        },
        {
            "label": "Test HomeAssistant Layer",
            "type": "shell",
            "command": [
                "clear && source /home/tom/projects/meta-sanctum/build-homeassistant/build/init-build-env && bitbake meta-homeassistant-image-ptest-all"
            ],
            "group": "test",
            "problemMatcher": []
        },
        {
            "label": "Test HomeAssistant Package",
            "type": "shell",
            "command": [
                "clear && source /home/tom/projects/meta-sanctum/build-homeassistant/build/init-build-env && bitbake meta-homeassistant-ptest-${input:recipeName}"
            ],
            "group": "test",
            "problemMatcher": []
        },
        {
            "label": "Initialize HomeAssistant",
            "type": "shell",
            "command": "${workspaceFolder}/scripts/init-bitbake-setup.sh homeassistant",
            "group": "none",
            "problemMatcher": []
        },
        {
            "label": "Build HomeAssistant",
            "type": "shell",
            "command": [
                "clear && source /home/tom/projects/meta-sanctum/build-homeassistant/build/init-build-env && bitbake -k core-image-homeassistant-full"
            ],
            "group": "build",
            "problemMatcher": []
        },
        {
            "label": "Build OpenEmbedded Test Environment",
            "type": "shell",
            "command": [
                "clear && source /home/tom/projects/meta-sanctum/build-homeassistant/build/init-build-env && bitbake -k core-image-test"
            ],
            "group": "build",
            "problemMatcher": []
        },
        {
            "label": "Initialize Sanctum",
            "type": "shell",
            "command": "${workspaceFolder}/scripts/init-bitbake-setup.sh sanctum",
            "group": "none",
            "problemMatcher": []
        },
        {
            "label": "Build Sanctum QemuX86-64n",
            "type": "shell",
            "command": [
                "clear && source /home/tom/projects/meta-sanctum/build-sanctum/build/init-build-env && bitbake-config-build enable-fragment machine/qemux86-64n && bitbake -k sanctum-bundle"
            ],
            "group": "build",
            "problemMatcher": []
        },
        {
            "label": "Build Sanctum Qemuarm64-a72",
            "type": "shell",
            "command": [
                "clear && source /home/tom/projects/meta-sanctum/build-sanctum/build/init-build-env && bitbake-config-build enable-fragment machine/qemuarm64-a72 && bitbake -k sanctum-bundle"
            ],
            "group": "build",
            "problemMatcher": []
        }
        // {
        //     "label": "checkout reterminal-kas",
        //     "type": "shell",
        //     "command": "kas checkout kas/targets/reterminal/reterminal-kas.yml",
        //     "hide": true,
        //     "problemMatcher": []
        // },
        // {
        //     "label": "bitbake sanctum-bundle",
        //     "type": "bitbake",
        //     "recipes": [
        //         "sanctum-bundle"
        //     ],
        //     "hide": true,

        // {
        //     "label": "Build Sanctum Reterminal",
        //     "dependsOn": [
        //         "checkout reterminal-kas",
        //         "bitbake sanctum-bundle"
        //     ],
        //     "dependsOrder": "sequence",
        //     "group": "build",
        //     "problemMatcher": []
        // },
    ],
    "inputs": [
        {
            "id": "haVersions",
            "description": "Enter Home Assistant versions (comma separated)",
            "type": "promptString"
        },
        {
            "id": "devtoolAddAction",
            "description": "devtool action (add/finish)",
            "type": "promptString"
        },
        {
            "id": "devtoolRecipeName",
            "description": "Enter the recipe name (e.g., homeassistant)",
            "type": "promptString"
        },
        {
            "id": "buildDirectory",
            "description": "Enter the build directory suffix (e.g., homeassistant)",
            "type": "promptString",
            "default": "homeassistant"
        },
        {
            "id": "recipeName",
            "description": "Enter the Recipe name",
            "type": "promptString"
        }
    ]
}